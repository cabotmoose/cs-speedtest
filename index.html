<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>CS | Speed Test</title>
        <link rel="stylesheet" href="css/app.css" />
        <script src="bower_components/modernizr/modernizr.js"></script>
        <!-- start Mixpanel --><script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
mixpanel.init("304821db8fdde3d1eedc9edf29796295");</script><!-- end Mixpanel -->
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44774081-2', 'auto');
  ga('send', 'pageview');
</script>
<script src="//speedof.me/api/api.js" type="text/javascript"></script>
    </head>
    <body>
    <div class="row">
        <div class="small-12 small-centered columns">
          <br/>
          <br/>
          <h3 class="text-center cs-font" id="cs-name">Speed test</h3>
          <br/>
          <br/>
        </div>
    </div>
    <div class="row">
      <div class="small-12 small-centered columns">
        <!--<div class="large-6 columns"> -->
          <div class = "panel">
            <div class="row">
              <div class = "large-4 small-3 columns">
                <h6><i class="fi-arrow-down"></i>  DL:</h6>
                <h6><i class="fi-arrow-up"></i>  UL:</h6>
                <h6><i class="fi-loop"></i>  Latency:</h6>
                <h6><i class="fi-shuffle"></i>  Jitter:</h6>
                <h6><i class="fi-at-sign"></i>  IP:</h6>
              </div>
              <div class = "large-4 small-5 columns" id="results">
              </div>
              <div class = "large-4 small-4 columns" id="context">
                <h6>Context 1</h6>
                <h6>Context 2</h6>
                <h6>Context 3</h6>
                <h6>Context 4</h6>
                <h6 id="ipDiv"></h6>
              </div>
            </div>
          </div>
          <h6 id="dlLabel"></h6>
          <div class="progress round">
            <span class="meter" style="width: 0%" id="DLMeter"></span>
          </div>
          <h6 id="ulLabel"></h6>
          <div class="progress round">
            <span class="meter" style="width: 0%" id="ULMeter"></span>
          </div>
          <br/>
          <div class="text-center small-centered columns">
            <button id="btnStart" class="button centered" onclick="btnStartClick()">Start</button>
          </div>
          
          <!-- <div class="panel" id="results">
            <h6>DL: - Mbps</h6>
            <h6>UL: - Mbps</h6>
            <h6>Latency: - ms</h6>
            <h6>Jitter: - ms</h6>
            <h6>IP: - </h6>
          </div>
          <h6 id="dlLabel"></h6>
          <div class="progress round">
            <span class="meter" style="width: 0%" id="DLMeter"></span>
          </div>
          <h6 id="ulLabel"></h6>
          <div class="progress round">
            <span class="meter" style="width: 0%" id="ULMeter"></span>
          </div>
          <br/>
          <div class="text-center small-centered columns">
            <button id="btnStart" class="button centered" onclick="btnStartClick()">Start</button>
          </div> -->
        <!--</div>  -->
      </div>
    </div> 
  <!-- <div id="footer" class="cs-icon-bar three-up">
      <a class="item" href="mailto:cabtmoose@gmail.com" target="_blank">
        <i class="fi-mail size-24"></i>
      </a>
      <a class="item" href="http://www.facebook.com/cameron.m.smith" target="_blank">
          <i class="fi-social-facebook size-24"></i>
      </a>
      <a class="item" href="http://www.github.com/cabotmoose" target="_blank">
          <i class="fi-social-github size-24"></i>
      </a>
  </div> -->
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/foundation/js/foundation.min.js"></script>
    <!-- Speed test js -->
    <script type="text/javascript">
        SomApi.account = "SOM55630fbc6fda3";  
        SomApi.domainName = "test.cameronsmith.io";   
        SomApi.onTestCompleted = onTestCompleted;
        SomApi.onError = onError;
        SomApi.onProgress = onProgress;

        var prgsDiv = document.getElementById("prgs");
        var results = document.getElementById("results");
        var dlMeter = document.getElementById("DLMeter");
        var ulMeter = document.getElementById("ULMeter");
        var ipAddrDiv = document.getElementById("ipDiv");

        function btnStartClick() {
          //SomApi.config.sustainTime= document.getElementById("speed-switch").value;
          SomApi.config.progress.enabled = true;
          SomApi.config.progress.verbose = true;
          SomApi.config.sustainTime = 2;
          SomApi.latencyTestEnabled = true;
          SomApi.uploadTestEnabled = true;
          SomApi.startTest();
        }

        function onTestCompleted(testResult) {
          $(ulMeter).animate({width:"100%"});

          results.innerHTML = 
          "<h6>" + testResult.download + " Mbps</h6>" +
          "<h6>" + testResult.upload + " Mbps</h6>" + 
          "<h6>" + testResult.latency + " ms</h6>" +
          "<h6>" + testResult.jitter + " ms</h6>" +
          "<h6>" + testResult.ip_address + " </h6>";

          ipAddrDiv.innerHTML = "<a href='www.reputationauthority.org/lookup.php?ip=" + testResult.ip_address +"'>View Map</a>"
        }

        function onProgress(progress) {
          if (progress.type == "download") {
            var wdth = progress.percentDone;
            var wdthPercent = wdth + "%";
            //console.log("DL Pass: " + progress.pass);
            //console.log("DL width: " + $(dlMeter).width());
            $(dlMeter).animate({width:wdth + "%"},0);

            dlLabel.innerHTML = "Download pass: " + progress.pass;

            if (wdthPercent == "100%") {
              $(dlMeter).parent().addClass('success');
              //console.log("Added DL success class");
            }
            else {
              if ($(dlMeter).parent().hasClass('success') == true) {
                $(dlMeter).parent().removeClass('success');
              }
            }
          }
          else if (progress.type == "upload") {
            //$(dlMeter).animate({width:"100%"}).parent().addClass('success');

            var wdth = progress.percentDone;
            var wdthPercent = wdth + "%";
            //console.log("UL Pass: " + progress.pass);
            $(ulMeter).animate({width:wdth + "%"},0); 

            ulLabel.innerHTML = "Upload pass: " + progress.pass;

            if (wdthPercent == "100%") {
              $(ulMeter).parent().addClass('success');
              //console.log("Added UL success class");
            }
            else {
              if ($(ulMeter).parent().hasClass('success') == true) {
                $(ulMeter).parent().removeClass('success');
              }
            }
          }
          //prgsDiv.innerHTML = 
          //"<h6>DL: " + "--" + " Mbps</h6><br/>" +
        //"<h6>UL: " + "--" + " Mbps</h6><br/>" + 
        //"<h6>Latency: " + "--" + " ms</h6><br/>" +
        //"<h6>Jitter: " + "--" + " ms</h6><br/>" +
        //"<h6>IP: " + "--" + " </h6>";
        }
        function onError(error) {
            results.innerHTML = "Error " + error.code + ": " + error.message;
        }
    </script>
    <script type="text/javascript">mixpanel.track("Speed test viewed");</script>
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/foundation/js/foundation.min.js"></script>
    <script src="js/app.js"></script>
    </body>
</html>